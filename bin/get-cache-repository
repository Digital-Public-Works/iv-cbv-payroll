#!/bin/bash
# Gets the ECR cache repository URL for the given app
# Prints the cache repository URL (e.g., 123456789.dkr.ecr.us-east-1.amazonaws.com/app-cache)

set -euo pipefail

app_name="$1"

# Initialize terraform to pull remote state from build-repository module
terraform -chdir="infra/${app_name}/build-repository" init > /dev/null

# Read the cache repository URL from the cache_repository module output
cache_repository_url=$(terraform -chdir="infra/${app_name}/build-repository" output -raw cache_repository_url)

echo "${cache_repository_url}"
